(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     29183,        784]
NotebookOptionsPosition[     27426,        749]
NotebookOutlinePosition[     27764,        764]
CellTagsIndexPosition[     27721,        761]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[TextData[{
 "1)  set J and calc. ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox[
    OverscriptBox["N", "^"], "ij", "J"], TraditionalForm]],ExpressionUUID->
  "49865b3a-27b2-4af0-a8c8-17f18fa94b39"],
 " and ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox[
    OverscriptBox["H", "^"], "ij", "J"], TraditionalForm]],ExpressionUUID->
  "ba22b889-d949-4b11-8649-13921043fb38"],
 "                      untainted/*.exe  boundstate with INQUA_N as in RHS \
calc.\n2)  "
}], "Text",
 CellChangeTimes->{{3.75595487137567*^9, 3.7559549173090973`*^9}, {
  3.756188794137376*^9, 3.7561888637464123`*^9}, {3.756188980470872*^9, 
  3.756189030390381*^9}, {3.756189060422544*^9, 3.75618907027845*^9}, {
  3.7562074314201202`*^9, 3.7562076203303223`*^9}, {3.7708203692681427`*^9, 
  3.770820545955739*^9}},
 Background->GrayLevel[
  0.85],ExpressionUUID->"e9d45b25-df6e-41e8-b248-8bbfc3bede55"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MUL", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"jj", " ", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mJ", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pi", "=", "\"\<-\>\""}], ";"}]}], "Input",
 CellLabel->
  "In[638]:=",ExpressionUUID->"99d4e7a7-645f-4af1-9723-21fcb6c69abd"],

Cell[TextData[{
 "Setup of the RHS of the LIT equation  ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       OverscriptBox["\[CapitalEta]", "^"], "-", 
       SubscriptBox["B", "deu"], "-", 
       SubscriptBox["\[Sigma]", "r"], "-", 
       SubscriptBox["i\[Sigma]", "i"]}], ")"}], " ", 
     SubsuperscriptBox["\[CapitalPsi]", "LIT", 
      SubscriptBox["Jm", "J"]]}], "=", 
    SuperscriptBox[
     RowBox[{"[", 
      RowBox[{
       OverscriptBox["O", "^"], 
       SubscriptBox["\[CapitalPsi]", "deu"]}], "]"}], 
     SubscriptBox["Jm", "J"]]}], TraditionalForm]],
  FontColor->GrayLevel[0],
  Background->GrayLevel[1],ExpressionUUID->
  "def27d84-927f-421d-abd2-a0c369ffb79b"],
 "  (which is a vector!)"
}], "Text",
 Background->GrayLevel[
  0.85],ExpressionUUID->"18666f82-2295-4f41-893c-5d747057a0a6"],

Cell[TextData[{
 "Setup of the LHS of the LIT equation  ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       OverscriptBox["\[CapitalEta]", "^"], "-", 
       SubscriptBox["B", "deu"], "-", 
       SubscriptBox["\[Sigma]", "r"], "-", 
       SubscriptBox["i\[Sigma]", "i"]}], ")"}], " ", 
     SubsuperscriptBox["\[CapitalPsi]", "LIT", 
      SubscriptBox["Jm", "J"]]}], "=", 
    SuperscriptBox[
     RowBox[{"[", 
      RowBox[{
       OverscriptBox["O", "^"], 
       SubscriptBox["\[CapitalPsi]", "deu"]}], "]"}], 
     SubscriptBox["Jm", "J"]]}], TraditionalForm]],
  FontColor->GrayLevel[0],
  Background->GrayLevel[1],ExpressionUUID->
  "85666630-ec22-4833-9a7f-472618771562"],
 "  \n\nRead Norm ",
 StyleBox[" ",
  FontColor->GrayLevel[0],
  Background->GrayLevel[1]],
 Cell[BoxData[
  FormBox[
   RowBox[{"(", " ", 
    SubscriptBox[
     SuperscriptBox["\[CapitalNu]", "J"], 
     RowBox[{
      SubscriptBox["l", "n"], 
      SubscriptBox["l", "m"]}]], ")"}], TraditionalForm]],
  FontColor->GrayLevel[0],
  Background->GrayLevel[1],ExpressionUUID->
  "6dec0b5a-0f09-4ffb-84e3-b4a04d029f7d"],
 "  and Hamilton ",
 StyleBox[" ",
  FontColor->GrayLevel[0],
  Background->GrayLevel[1]],
 Cell[BoxData[
  FormBox[
   RowBox[{"(", " ", 
    SubscriptBox[
     SuperscriptBox["\[CapitalEta]", "J"], 
     RowBox[{
      SubscriptBox["l", "n"], 
      SubscriptBox["l", "m"]}]], ")"}], TraditionalForm]],
  FontColor->GrayLevel[0],
  Background->GrayLevel[1],ExpressionUUID->
  "9fe94509-6107-43aa-adc9-851eefb98093"],
 "  Matrix dimensionality for ",
 Cell[BoxData[
  FormBox[
   RowBox[{" ", 
    RowBox[{"J", "=", 
     RowBox[{"{", GridBox[{
        {
         RowBox[{"0", ":", " ", 
          SubscriptBox["N", "1"]}]},
        {
         RowBox[{"1", ":", " ", 
          RowBox[{
           SubscriptBox["N", "0"], "+", 
           SubscriptBox["N", "1"], "+", 
           SubscriptBox["N", "2"]}]}]},
        {
         RowBox[{"2", ":", " ", 
          RowBox[{
           SubscriptBox["N", "1"], "+", 
           SubscriptBox["N", "2"], "+", 
           SubscriptBox["N", "3"]}]}]}
       }]}]}]}], TraditionalForm]],ExpressionUUID->
  "fc5a30f6-5775-4266-abe5-b233ed059e51"]
}], "Text",
 Background->GrayLevel[
  0.85],ExpressionUUID->"242bb349-f3e7-4ce1-9058-ab8a0db51192"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"momentum", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sigmaI", "=", "5.5"}], ";", 
  RowBox[{"smin", "=", "1"}], ";", 
  RowBox[{"smax", "=", "400"}], ";", 
  RowBox[{"nbrs", "=", "100"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sigmaRange", "=", 
   RowBox[{"Range", "[", 
    RowBox[{"smin", ",", "smax", ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"smax", "-", "smin"}], ")"}], "/", "nbrs"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"file", "=", 
   RowBox[{
   "\"\</home_th/kirscher/kette_repo/source/ComptonLIT/av18_deuteron/norm-ham-\
litME-\>\"", "<>", 
    RowBox[{"ToString", "[", "jj", "]"}], "<>", "pi"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NormHamMat", "=", 
   RowBox[{"ReadList", "[", 
    RowBox[{"file", ",", "Number"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"JbasisDim", "=", 
   RowBox[{"NormHamMat", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"norm", "=", 
   RowBox[{"ArrayReshape", "[", 
    RowBox[{
     RowBox[{"NormHamMat", "[", 
      RowBox[{"[", 
       RowBox[{"2", ";;", 
        RowBox[{
         RowBox[{"JbasisDim", "^", "2"}], "+", "1"}]}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"JbasisDim", ",", "JbasisDim"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"ham", "=", 
   RowBox[{"ArrayReshape", "[", 
    RowBox[{
     RowBox[{"NormHamMat", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{
         RowBox[{"JbasisDim", "^", "2"}], "+", "2"}], ";;", 
        RowBox[{
         RowBox[{"2", " ", 
          RowBox[{"JbasisDim", "^", "2"}]}], "+", "1"}]}], "]"}], "]"}], ",", 
     
     RowBox[{"{", 
      RowBox[{"JbasisDim", ",", "JbasisDim"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"file", "=", 
   RowBox[{
   "\"\</home_th/kirscher/kette_repo/source/ComptonLIT/av18_deuteron/LIT_\
SOURCE_\>\"", "<>", 
    RowBox[{"ToString", "[", "jj", "]"}], "<>", "pi", "<>", 
    RowBox[{"ToString", "[", "mJ", "]"}], "<>", 
    RowBox[{"ToString", "[", "MUL", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RHS", "=", 
   RowBox[{"ReadList", "[", 
    RowBox[{"file", ",", "Real", ",", 
     RowBox[{"RecordLists", "\[Rule]", "True"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Dimensions", "[", "norm", "]"}], ";", 
  RowBox[{"Dimensions", "[", "ham", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SlitDim", "=", 
   RowBox[{
    RowBox[{"Dimensions", "[", 
     RowBox[{"RHS", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"JbasisDim", "==", "SlitDim"}], ")"}], "\[Equal]", "False"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "Print", "[", 
      "\"\<Dim(Norm/H) \[NotEqual] Dim(\!\(\*SubscriptBox[\(S\), \
\(LIT\)]\))\>\"", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Dim(Norm/H) = \>\"", "<>", 
       RowBox[{"ToString", "[", "JbasisDim", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
      "\"\<Dim(\!\(\*SubscriptBox[\(S\), \(LIT\)]\))   = \>\"", "<>", 
       RowBox[{"ToString", "[", "SlitDim", "]"}]}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"inhomo", "=", 
   RowBox[{"RHS", "[", 
    RowBox[{"[", "momentum", "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"lOfSigma", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"n", "=", "1"}], ",", 
    RowBox[{"n", "<", "nbrs"}], ",", 
    RowBox[{"n", "++"}], ",", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        SubscriptBox["\[Sigma]", "r"], "=", "n"}], ";", 
       RowBox[{
        SubscriptBox["\[Sigma]", "i"], "=", "5"}], ";", 
       RowBox[{"\[Sigma]", "=", 
        RowBox[{
         SubscriptBox["\[Sigma]", "r"], "+", 
         RowBox[{"I", " ", 
          SubscriptBox["\[Sigma]", "i"]}]}]}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"coeff", "=", 
       RowBox[{"LinearSolve", "[", 
        RowBox[{
         RowBox[{"ham", "-", 
          RowBox[{
           RowBox[{"Conjugate", "[", 
            RowBox[{
             RowBox[{"sigmaRange", "[", 
              RowBox[{"[", "n", "]"}], "]"}], "+", 
             RowBox[{"sigmaI", " ", "I"}]}], "]"}], " ", "norm"}]}], ",", 
         "inhomo"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"lOfSigma", "=", 
       RowBox[{"Append", "[", 
        RowBox[{"lOfSigma", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"sigmaRange", "[", 
            RowBox[{"[", "n", "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"Conjugate", "[", "coeff", "]"}], ".", "norm", ".", 
            "coeff"}]}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
     ")"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LIToverlap", "=", 
   RowBox[{"Append", "[", 
    RowBox[{"LIToverlap", ",", "lOfSigma"}], "]"}]}], ";", 
  RowBox[{"ListPlot", "[", 
   RowBox[{
    RowBox[{"Re", "[", "lOfSigma", "]"}], ",", 
    RowBox[{"PlotLegends", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<\!\(\*SuperscriptBox[\(J\), \(LIT\)]\) = \>\"", "<>", 
       RowBox[{"ToString", "[", "jj", "]"}]}], "}"}]}], ",", 
    RowBox[{"AxesLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<\!\(\*SubscriptBox[\(\[Sigma]\), \(r\)]\)\>\"", ",", 
       "\"\<Re{\!\(\*SubscriptBox[\(L\), \(j\)]\)(\!\(\*SubscriptBox[\(\
\[Sigma]\), \(r\)]\))}\>\""}], "}"}]}]}], "]"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"10", "^", 
         RowBox[{"(", 
          RowBox[{"-", "6"}], ")"}]}]}], "}"}]}]}], "]"}], "*)"}]}]}], "Input",\

 CellLabel->
  "In[1938]:=",ExpressionUUID->"348a6917-f068-4004-82a0-c08d464b8ef6"],

Cell[BoxData[
 TemplateBox[{GraphicsBox[{{}, {{{
        Directive[
         PointSize[0.011000000000000001`], 
         RGBColor[0.368417, 0.506779, 0.709798], 
         AbsoluteThickness[1.6]], 
        PointBox[CompressedData["
1:eJwtlAtMU3cUxnkKwyJCcYLbBM00Eh7ycqiDv18BEcwkgiCCKBQoYOVVSim6
VRFEA+VR3gObgYAisFTETWSIisCcwyfqcIJhgs7wcGKcjMWhaz2e5Obm5v7v
d77z/U7usqjkQIGOlpZWtPrS3KmmN+icWZ0leFHPZlaFF115zcV39cy15Xjj
h+dlOH2k5dH9401M5GE0WD9tgyOd/gXdEyc/vHeEt0Xp4vrhk8xFU69c4aDi
ChLmmj+cX4vii4eCJ4PPMtWmx/vN/3IHU3qekVteou8lwPL/Mp1PKS8xc82B
NE8csL1iuUNwlvTE3hiRdW8zaWtigeeX5kyKfCBBhfNrTgPpp/hieS+erDh4
nKnNrApP3ozFogeBU8Ja6pf0FSr75q0d8KhlN66rK8Ef3/6tV+12u5b6r9kK
04jZGaVbHcuZDDi/dE0AGtytlL9cbSA/roFIenwtxMC9iTWkqBu6bIPjsQex
yspW8ucSBN32604TbudZj7p9kXMwYs/Y33ni0Ut+nbZj33xtma/sLlO7UW1y
CkFx0ufPXw78Qf4dd0DpH/rRuv6H7D0Ox1DM76vxtOX10zyrw5DRmhcnHOxi
VhqDDjtxa1TVaXqujeZzCMeMZN7Ds+bN7H0c9rsg3+JnY1xbT/Pa7YbVv176
ZqyGaWitsovAuEf5zLnpKpp/USQOanc4clFB35dHIiCoghdbXkp5LOKjPUP8
MasuJr0yPqw/DXqbs0RB+ZhHwXBDV1D4ZAHpl0Whze5mT4d9PuXFjUZTkJa/
1+M8NqWWyymNxr0p6U2D17mUHzcG3DKz6fURuexrjWBJDIa6346pPsmlPM0E
qJr1tLCxzWUaex4lArx18hLGlOZSvqaxaucu3l0Reay6Sl3FsVj6cltPS52c
8jaNwxxqxqMzCpiNxqAiDqPZIz4N+grKf2E8Blzn5i7cKGYauQBFPAqXOJlp
+ZQRj4V70LpPGRTQVcl8NYJFe7BkXUdQ4zkl8TER4tiD2QzZ/DqmsWdUJIT5
mP+W5t5G4rVgL25fyHpqf6yVxWqqcC8UIcveKEw7iN+CBHTmiPP2veklHgUJ
eFkXsa555i7xME7EHrFPFufpGPEoSETNYFThcMcz4sFJglvVllMX/R4Sj/wk
GKtyRqWCX4kHJxmnV167FDbeRTzkyWib4g399qKN+umnICTxkfU8vWbKb2MK
oi/U8xP/qaP+OSmQlLd8MzCupDz7UpB2renQuxsV5EdfhFf23RcN95dQvt4i
nNhtKBmpLCR/h0W4fjDrqO3VXMq7V4T4m0NrfI2OkF+9VGRzVtad4GZT/t6p
EBpU6fNOZ5L/w6lgMfI/+aky4tGbijLXiavGjvtpHl0xNvP149tSpcTHS4wf
ne32WltJaN+yxTCzlXo8txYTrx4xdpqs33Q0XkT7p5sGh89spf13k4mfVxpG
/NoL3N0SaR+z0nDC0qhLNiUknlfSoFN7gPP9s3jaTx0JVPdDGr6wiiO+nhKU
ePf575ILaF+zJHDl2chvrYgh3uofXnX/8Obo8SjaX+10bM//2fLRHT7x4KVj
bOKJT99QJPE4lI7G2ZZRH71I4tGdDrGhUGFXspt4aEsx6NfB6dy6i3jwpPhy
RPdZGC+ceGRK8Y5nYPKUv5N4XJZCdtmi/ffWMOKhlYHb+Xd+CrYPIx7IQMDR
H4Y5g6HEIzMDCfcs5L6qUPY/82fLzg==
         "]]}}, {{
        Directive[
         PointSize[0.011000000000000001`], 
         RGBColor[0.368417, 0.506779, 0.709798], 
         AbsoluteThickness[1.6]]}, {}}, {{
        Directive[
         PointSize[0.011000000000000001`], 
         RGBColor[0.368417, 0.506779, 0.709798], 
         AbsoluteThickness[1.6]]}, {}}}, {{}, {}}}, {
    DisplayFunction -> Identity, DisplayFunction -> Identity, AspectRatio -> 
     NCache[GoldenRatio^(-1), 0.6180339887498948], Axes -> {True, True}, 
     AxesLabel -> {
       FormBox[
       "\"\\!\\(\\*SubscriptBox[\\(\[Sigma]\\), \\(r\\)]\\)\"", 
        TraditionalForm], 
       FormBox[
       "\"Re{\\!\\(\\*SubscriptBox[\\(L\\), \
\\(j\\)]\\)(\\!\\(\\*SubscriptBox[\\(\[Sigma]\\), \\(r\\)]\\))}\"", 
        TraditionalForm]}, AxesOrigin -> {0, 0}, DisplayFunction :> Identity, 
     Frame -> {{False, False}, {False, False}}, 
     FrameLabel -> {{None, None}, {None, None}}, 
     FrameTicks -> {{Automatic, Automatic}, {Automatic, Automatic}}, 
     GridLines -> {None, None}, GridLinesStyle -> Directive[
       GrayLevel[0.5, 0.4]], 
     Method -> {
      "OptimizePlotMarkers" -> True, 
       "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
           (Identity[#]& )[
            Part[#, 1]], 
           (Identity[#]& )[
            Part[#, 2]]}& ), "CopiedValueFunction" -> ({
           (Identity[#]& )[
            Part[#, 1]], 
           (Identity[#]& )[
            Part[#, 2]]}& )}}, 
     PlotRange -> {{0, 392.02}, {0, 2.8085827699202574`*^-6}}, 
     PlotRangeClipping -> True, PlotRangePadding -> {{
        Scaled[0.02], 
        Scaled[0.02]}, {
        Scaled[0.02], 
        Scaled[0.05]}}, Ticks -> {Automatic, Automatic}}],FormBox[
    FormBox[
     TemplateBox[{"\"\\!\\(\\*SuperscriptBox[\\(J\\), \\(LIT\\)]\\) = 0\""}, 
      "PointLegend", DisplayFunction -> (FormBox[
        StyleBox[
         StyleBox[
          PaneBox[
           TagBox[
            GridBox[{{
               TagBox[
                GridBox[{{
                   GraphicsBox[{{}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[1.6]], {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[1.6]], 
                    PointBox[
                    NCache[{
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}]}, {
                    Scaled[{0.5, 0.5}]}]]}}}, AspectRatio -> Full, 
                    ImageSize -> {10, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #}}, 
                 GridBoxAlignment -> {
                  "Columns" -> {Center, Left}, "Rows" -> {{Baseline}}}, 
                 AutoDelete -> False, 
                 GridBoxDividers -> {
                  "Columns" -> {{False}}, "Rows" -> {{False}}}, 
                 GridBoxItemSize -> {"Columns" -> {{All}}, "Rows" -> {{All}}},
                  GridBoxSpacings -> {
                  "Columns" -> {{0.5}}, "Rows" -> {{0.8}}}], "Grid"]}}, 
             GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
             AutoDelete -> False, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{1}}, "Rows" -> {{0}}}], 
            "Grid"], Alignment -> Left, AppearanceElements -> None, 
           ImageMargins -> {{5, 5}, {5, 5}}, ImageSizeAction -> 
           "ResizeToFit"], LineIndent -> 0, StripOnInput -> False], {
         FontFamily -> "Arial"}, Background -> Automatic, StripOnInput -> 
         False], TraditionalForm]& ), 
      InterpretationFunction :> (RowBox[{"PointLegend", "[", 
         RowBox[{
           RowBox[{"{", 
             RowBox[{"Directive", "[", 
               RowBox[{
                 RowBox[{"PointSize", "[", "0.011000000000000001`", "]"}], 
                 ",", 
                 InterpretationBox[
                  ButtonBox[
                   TooltipBox[
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    RectangleBox[{0, -1}, {2, 1}]}}, DefaultBaseStyle -> 
                    "ColorSwatchGraphics", AspectRatio -> 1, Frame -> True, 
                    FrameStyle -> 
                    RGBColor[
                    0.24561133333333335`, 0.3378526666666667, 
                    0.4731986666666667], FrameTicks -> None, PlotRangePadding -> 
                    None, ImageSize -> 
                    Dynamic[{
                    Automatic, 1.35 CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification]}]], 
                    StyleBox[
                    RowBox[{"RGBColor", "[", 
                    RowBox[{"0.368417`", ",", "0.506779`", ",", "0.709798`"}],
                     "]"}], NumberMarks -> False]], Appearance -> None, 
                   BaseStyle -> {}, BaselinePosition -> Baseline, 
                   DefaultBaseStyle -> {}, ButtonFunction :> 
                   With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[0.368417, 0.506779, 0.709798]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                   Automatic, Method -> "Preemptive"], 
                  RGBColor[0.368417, 0.506779, 0.709798], Editable -> False, 
                  Selectable -> False], ",", 
                 RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}], 
             "}"}], ",", 
           RowBox[{"{", #, "}"}], ",", 
           RowBox[{"LegendMarkers", "\[Rule]", 
             RowBox[{"{", 
               RowBox[{"{", 
                 RowBox[{"False", ",", "Automatic"}], "}"}], "}"}]}], ",", 
           RowBox[{"Joined", "\[Rule]", 
             RowBox[{"{", "False", "}"}]}], ",", 
           RowBox[{"LabelStyle", "\[Rule]", 
             RowBox[{"{", "}"}]}], ",", 
           RowBox[{"LegendLayout", "\[Rule]", "\"Column\""}]}], "]"}]& ), 
      Editable -> True], TraditionalForm], TraditionalForm]},
  "Legended",
  DisplayFunction->(GridBox[{{
      TagBox[
       ItemBox[
        PaneBox[
         TagBox[#, "SkipImageSizeLevel"], Alignment -> {Center, Baseline}, 
         BaselinePosition -> Baseline], DefaultBaseStyle -> "Labeled"], 
       "SkipImageSizeLevel"], 
      ItemBox[#2, DefaultBaseStyle -> "LabeledLabel"]}}, 
    GridBoxAlignment -> {"Columns" -> {{Center}}, "Rows" -> {{Center}}}, 
    AutoDelete -> False, GridBoxItemSize -> Automatic, 
    BaselinePosition -> {1, 1}]& ),
  Editable->True,
  InterpretationFunction->(RowBox[{"Legended", "[", 
     RowBox[{#, ",", 
       RowBox[{"Placed", "[", 
         RowBox[{#2, ",", "After"}], "]"}]}], "]"}]& )]], "Output",
 CellLabel->
  "Out[1953]=",ExpressionUUID->"24accc53-6068-4c7a-b93a-23ff88b48fc6"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Phi]", "=", 
   RowBox[{"Pi", "/", "3"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Theta]", "=", 
   RowBox[{"Pi", "/", "3"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"Re", "[", 
    RowBox[{"expandedState", "[", 
     RowBox[{
      RowBox[{"r", " ", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
      RowBox[{"r", " ", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
      RowBox[{"r", " ", 
       RowBox[{"Cos", "[", "\[Phi]", "]"}]}], ",", 
      RowBox[{"Lsets", "[", 
       RowBox[{"[", 
        RowBox[{"jj", "+", "1"}], "]"}], "]"}], ",", "basisWidths", ",", 
      "coeff"}], "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"r", ",", ".01", ",", "6.5"}], "}"}]}], "]"}]}], "Input",Expressio\
nUUID->"48139b0f-4c4c-4702-b83c-24049f6f59f6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"basisWidths", "//", "MatrixForm"}]], "Input",
 CellLabel->
  "In[286]:=",ExpressionUUID->"d78afd4c-8a26-41a2-988d-0f529b408a9d"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{"{", 
        RowBox[{
        "12.95665`", ",", "5.13467`", ",", "2.939`", ",", "1.690174`", ",", 
         "0.843`", ",", "0.257369`", ",", "0.13852`", ",", "0.038519`"}], 
        "}"}]},
      {
       RowBox[{"{", 
        RowBox[{
        "0.444741`", ",", "2.939`", ",", "1.690174`", ",", "1.185236`", ",", 
         "0.843`", ",", "0.50011`"}], "}"}]},
      {
       RowBox[{"{", 
        RowBox[{
        "0.444741`", ",", "2.939`", ",", "1.690174`", ",", "1.185236`", ",", 
         "0.843`", ",", "0.50011`"}], "}"}]},
      {
       RowBox[{"{", 
        RowBox[{
        "0.444741`", ",", "2.939`", ",", "1.690174`", ",", "1.185236`", ",", 
         "0.843`", ",", "0.50011`"}], "}"}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->
  "Out[286]//MatrixForm=",ExpressionUUID->"1e2301c6-0739-43fa-9384-\
feecbc9dd0ad"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"normmalcoeff", "=", 
  RowBox[{"norm", ".", "coeff"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"normmalcoeff", ".", "coeff"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Conjugate", "[", "coeff", "]"}], ".", "norm", ".", 
  "coeff"}]}], "Input",
 CellLabel->
  "In[319]:=",ExpressionUUID->"b2cc3cee-e030-411f-9841-965b2e0fc27e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"1.05784798193626`*^-6", "+", 
    RowBox[{"3.0604852457194604`*^-8", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"2.4140154286986812`*^-8", "+", 
    RowBox[{"7.408473003949084`*^-10", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"8.603160271043213`*^-8", "+", 
    RowBox[{"2.533631826001913`*^-9", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"1.8604365933017988`*^-7", "+", 
    RowBox[{"5.4230113608787794`*^-9", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"3.6871472698320685`*^-7", "+", 
    RowBox[{"1.0702235638050137`*^-8", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{"8.946367099623369`*^-7", "+", 
    RowBox[{"2.589623858840557`*^-8", " ", "\[ImaginaryI]"}]}]}], 
  "}"}]], "Output",
 CellLabel->
  "Out[319]=",ExpressionUUID->"753444d7-da47-47ae-bcbe-bd1a2a573ac7"],

Cell[BoxData[
 TagBox[
  RowBox[{"1.3658778466377962`*^-12", "+", 
   RowBox[{"7.918691252246658`*^-14", " ", "\[ImaginaryI]"}]}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->
  "Out[320]//MatrixForm=",ExpressionUUID->"df54cf0a-1c98-4658-8e20-\
5ad3d3087452"],

Cell[BoxData[
 RowBox[{"1.3681728297861464`*^-12", "-", 
  RowBox[{"1.3126645462877636`*^-27", " ", "\[ImaginaryI]"}]}]], "Output",
 CellLabel->
  "Out[321]=",ExpressionUUID->"bb2fa4b1-b405-46c4-87ca-ebbe6e181706"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ell", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"m1", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"m2", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "ell"}], "+", "1"}], ")"}], "!!"}], "/", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", "^", 
      RowBox[{"(", 
       RowBox[{"2", "+", "ell"}], ")"}]}], " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"basisWidths", "[", 
          RowBox[{"[", 
           RowBox[{"ell", "+", "1"}], "]"}], "]"}], "[", 
         RowBox[{"[", "m1", "]"}], "]"}], "+", 
        RowBox[{
         RowBox[{"basisWidths", "[", 
          RowBox[{"[", 
           RowBox[{"ell", "+", "1"}], "]"}], "]"}], "[", 
         RowBox[{"[", "m2", "]"}], "]"}]}], ")"}], "^", 
      RowBox[{"(", 
       RowBox[{"1", "+", "ell"}], ")"}]}]}], ")"}]}], " ", 
  RowBox[{"Sqrt", "[", 
   RowBox[{"Pi", "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"basisWidths", "[", 
        RowBox[{"[", 
         RowBox[{"ell", "+", "1"}], "]"}], "]"}], "[", 
       RowBox[{"[", "m1", "]"}], "]"}], "+", 
      RowBox[{
       RowBox[{"basisWidths", "[", 
        RowBox[{"[", 
         RowBox[{"ell", "+", "1"}], "]"}], "]"}], "[", 
       RowBox[{"[", "m2", "]"}], "]"}]}], ")"}]}], "]"}]}]}], "Input",
 CellLabel->
  "In[294]:=",ExpressionUUID->"f917dd50-156e-4265-b3e3-580a9f76d6df"],

Cell[BoxData["0.07682792956887868`"], "Output",
 CellLabel->
  "Out[297]=",ExpressionUUID->"358478d2-a09d-48b6-8311-1593f5844650"]
}, Open  ]]
},
WindowSize->{1920, 1043},
WindowMargins->{{-1920, Automatic}, {0, Automatic}},
FrontEndVersion->"12.0 for Linux x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 890, 22, 84, "Text",ExpressionUUID->"e9d45b25-df6e-41e8-b248-8bbfc3bede55"],
Cell[1451, 44, 374, 10, 101, "Input",ExpressionUUID->"99d4e7a7-645f-4af1-9723-21fcb6c69abd"],
Cell[1828, 56, 852, 26, 62, "Text",ExpressionUUID->"18666f82-2295-4f41-893c-5d747057a0a6"],
Cell[2683, 84, 2332, 78, 145, "Text",ExpressionUUID->"242bb349-f3e7-4ce1-9058-ab8a0db51192"],
Cell[CellGroupData[{
Cell[5040, 166, 6202, 179, 615, "Input",ExpressionUUID->"348a6917-f068-4004-82a0-c08d464b8ef6"],
Cell[11245, 347, 10138, 213, 268, "Output",ExpressionUUID->"24accc53-6068-4c7a-b93a-23ff88b48fc6"]
}, Open  ]],
Cell[21398, 563, 958, 26, 78, "Input",ExpressionUUID->"48139b0f-4c4c-4702-b83c-24049f6f59f6"],
Cell[CellGroupData[{
Cell[22381, 593, 152, 3, 31, "Input",ExpressionUUID->"d78afd4c-8a26-41a2-988d-0f529b408a9d"],
Cell[22536, 598, 1422, 41, 105, "Output",ExpressionUUID->"1e2301c6-0739-43fa-9384-feecbc9dd0ad"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23995, 644, 386, 10, 78, "Input",ExpressionUUID->"b2cc3cee-e030-411f-9841-965b2e0fc27e"],
Cell[24384, 656, 823, 17, 40, "Output",ExpressionUUID->"753444d7-da47-47ae-bcbe-bd1a2a573ac7"],
Cell[25210, 675, 291, 8, 52, "Output",ExpressionUUID->"df54cf0a-1c98-4658-8e20-5ad3d3087452"],
Cell[25504, 685, 214, 4, 37, "Output",ExpressionUUID->"bb2fa4b1-b405-46c4-87ca-ebbe6e181706"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25755, 694, 1522, 48, 101, "Input",ExpressionUUID->"f917dd50-156e-4265-b3e3-580a9f76d6df"],
Cell[27280, 744, 130, 2, 35, "Output",ExpressionUUID->"358478d2-a09d-48b6-8311-1593f5844650"]
}, Open  ]]
}
]
*)

